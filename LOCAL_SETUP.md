# Master Plan - Local Development Setup

This guide will help you set up and run the Master Plan application locally.

## Prerequisites

Before you begin, ensure you have the following installed:

- **Node.js**: v16 or later
- **npm** or **yarn**
- **Git**

## 1. Clone the Repository

Clone the project to your local machine:

```bash
git clone <repository-url>
cd PersonalLearningPro
```

## 2. Install Dependencies

Install the necessary packages using npm or yarn:

```bash
npm install
```
or
```bash
yarn install
```

## 3. Environment Variables

Create a `.env` file in the root of the project and add the following environment variables.

```env
# Firebase Configuration
VITE_FIREBASE_API_KEY=your_firebase_api_key
VITE_FIREBASE_PROJECT_ID=your_firebase_project_id
VITE_FIREBASE_APP_ID=your_firebase_app_id

# Database
DATABASE_URL=your_postgresql_connection_string

# OpenAI
OPENAI_API_KEY=your_openai_api_key
```

### Obtaining Credentials:

- **Firebase**:
    1. Go to the [Firebase Console](https://console.firebase.google.com/).
    2. Create a new project or use an existing one.
    3. Add a new web application.
    4. Enable "Google" as a Sign-in method in the "Authentication" section.
    5. Copy the configuration credentials into your `.env` file.

- **Database (Neon)**:
    1. Go to [Neon](https://neon.tech/).
    2. Create a new project.
    3. Copy the PostgreSQL connection string for your branch and add it to the `DATABASE_URL` in your `.env` file.

- **OpenAI**:
    1. Go to the [OpenAI API platform](https://platform.openai.com/).
    2. Get your API key and add it to the `OPENAI_API_KEY` in your `.env` file.


## 4. Database Setup

Once you've configured your `DATABASE_URL`, you need to push the schema to your database:

```bash
npm run db:push
```

This command uses Drizzle ORM to update your database schema according to `shared/schema.ts`.


## 5. Clean Up Replit Configuration

For a clean local setup, you should remove the Replit-specific packages and configuration.

### a. Remove Replit packages from `package.json`

Uninstall the following packages:
```bash
npm uninstall @replit/vite-plugin-shadcn-theme-json @replit/vite-plugin-cartographer @replit/vite-plugin-runtime-error-modal
```

### b. Update `vite.config.ts`

Open `vite.config.ts` and remove the Replit plugins. The file should look like this:

```ts
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import path from "path";

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "client", "src"),
      "@shared": path.resolve(__dirname, "shared"),
      "@assets": path.resolve(__dirname, "attached_assets"),
    },
  },
  root: path.resolve(__dirname, "client"),
  build: {
    outDir: path.resolve(__dirname, "dist/public"),
    emptyOutDir: true,
  },
});
```

## 6. Update `package.json` Scripts

The `dev` script in `package.json` should be updated to run the client and server concurrently. You'll need to install `concurrently` as a dev dependency.

```bash
npm install --save-dev concurrently
```

Then, update the `"scripts"` section in your `package.json`:

```json
"scripts": {
  "dev": "concurrently \\"vite\\" \\"tsx server/index.ts\\"",
  "dev:client": "vite",
  "dev:server": "tsx server/index.ts",
  "build": "vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist",
  "start": "NODE_ENV=production node dist/index.js",
  "check": "tsc",
  "db:push": "drizzle-kit push"
}
```

## 7. Start the Application

You can now start the application in development mode:

```bash
npm run dev
```

Alternatively, you can run the client and server in separate terminals:

**Terminal 1 (Client):**
```bash
npm run dev:client
```

**Terminal 2 (Server):**
```bash
npm run dev:server
```

The application will be available at the following URLs:

- **Frontend**: `http://localhost:5173`
- **Backend API**: `http://localhost:5001`

## Project Structure

- `client/src/`: Contains all frontend React code.
- `server/`: Contains the backend Express server code.
- `shared/`: Code shared between the frontend and backend, including the database schema.
- `migrations/`: Database migration files generated by Drizzle Kit.

## Troubleshooting

- **Port Conflicts**: If port 5001 or 5173 is already in use, you can configure the ports in `server/index.ts` and `vite.config.ts`.
- **Firebase Authentication**: Ensure you've enabled Google Authentication in your Firebase project.
- **Environment Variables**: Double-check that your `.env` file is in the root of the project and that all variables are set correctly.
- **Installation Errors**: If you encounter issues, try removing `node_modules` and `package-lock.json` and running `npm install` again.

